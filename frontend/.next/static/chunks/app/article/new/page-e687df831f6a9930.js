(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[741],{2129:function(e,t,r){Promise.resolve().then(r.bind(r,4079))},4079:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return b}});var a=r(7437),s=r(2265),l=r(9376),n=r(8572),i=r(9763);let o=(0,i.Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);var c=r(5863);let d=(0,i.Z)("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);var x=r(7648);let g=(0,i.Z)("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]);var m=r(2208),h=r(1656);function u(e){let{value:t,onChange:r,placeholder:l}=e,[n,i]=(0,s.useState)("write");return(0,a.jsxs)("div",{className:"border border-gray-300 dark:border-gray-600 rounded-lg overflow-hidden",children:[(0,a.jsxs)("div",{className:"flex border-b border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-800",children:[(0,a.jsxs)("button",{type:"button",onClick:()=>i("write"),className:"flex items-center space-x-2 px-4 py-2 text-sm font-medium ".concat("write"===n?"text-violet-600 dark:text-violet-400 bg-white dark:bg-gray-700 border-b-2 border-violet-600 dark:border-violet-400":"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300"),children:[(0,a.jsx)(g,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Write"})]}),(0,a.jsxs)("button",{type:"button",onClick:()=>i("preview"),className:"flex items-center space-x-2 px-4 py-2 text-sm font-medium ".concat("preview"===n?"text-violet-600 dark:text-violet-400 bg-white dark:bg-gray-700 border-b-2 border-violet-600 dark:border-violet-400":"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300"),children:[(0,a.jsx)(m.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Preview"})]})]}),(0,a.jsx)("div",{className:"min-h-[400px]",children:"write"===n?(0,a.jsx)("textarea",{value:t,onChange:e=>r(e.target.value),placeholder:l||"Write your article in Markdown...",className:"w-full h-[400px] p-4 border-none resize-none focus:outline-none bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 placeholder-gray-500 dark:placeholder-gray-400",style:{fontFamily:'ui-monospace, SFMono-Regular, "SF Mono", monospace'}}):(0,a.jsx)("div",{className:"p-4 bg-white dark:bg-gray-700 min-h-[400px]",children:t.trim()?(0,a.jsx)(h.Z,{content:t}):(0,a.jsx)("p",{className:"text-gray-500 dark:text-gray-400 italic",children:"Nothing to preview. Start writing in the Write tab."})})}),"write"===n&&(0,a.jsxs)("div",{className:"px-4 py-2 bg-gray-50 dark:bg-gray-800 border-t border-gray-300 dark:border-gray-600 text-xs text-gray-500 dark:text-gray-400",children:[(0,a.jsx)("span",{className:"font-medium",children:"Markdown tips:"}),(0,a.jsxs)("span",{className:"ml-2",children:["**bold** *italic* `code` [link](url) # heading ## subheading - list item ",">"," quote"]})]})]})}var y=r(1837);function b(){let[e,t]=(0,s.useState)({title:"",content:"",image_url:"",tags:[]}),[r,i]=(0,s.useState)(""),[g,m]=(0,s.useState)(!1),[h,b]=(0,s.useState)(""),[p,k]=(0,s.useState)(""),[v,f]=(0,s.useState)(!1),j=(0,l.useRouter)();(0,s.useEffect)(()=>{localStorage.getItem("auth_token")?f(!0):j.push("/login")},[j]);let N=async t=>{if(t.preventDefault(),!e.title.trim()||!e.content.trim()){b("Название и контент обязательны");return}m(!0),b(""),k("");try{let t=await y.x.createArticle(e);t.success?(k("Статья успешно опубликована!"),setTimeout(()=>{j.push("/article/".concat(t.data.id))},2e3)):b(t.message||"Не вышло создать статью.")}catch(e){b("Ошибка при создании статьи. Попробуйте ещё раз."),console.error("Ошибка при создании статьи:",e)}finally{m(!1)}},w=e=>{let{name:r,value:a}=e.target;t(e=>({...e,[r]:a})),h&&b("")},S=e=>{t(t=>({...t,tags:t.tags.filter(t=>t!==e)}))};return v?(0,a.jsxs)("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,a.jsx)("div",{className:"flex items-center justify-between mb-8",children:(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)(x.default,{href:"/",className:"inline-flex items-center space-x-2 text-violet-600 hover:text-violet-700 font-medium",children:[(0,a.jsx)(n.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Назад"})]}),(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:"Создать новую статью"})]})}),(0,a.jsxs)("form",{onSubmit:N,className:"space-y-6",children:[h&&(0,a.jsx)("div",{className:"bg-red-50 dark:bg-red-900 border border-red-200 dark:border-red-700 rounded-lg p-4",children:(0,a.jsx)("p",{className:"text-sm text-red-600 dark:text-red-400",children:h})}),p&&(0,a.jsx)("div",{className:"bg-green-50 dark:bg-green-900 border border-green-200 dark:border-green-700 rounded-lg p-4",children:(0,a.jsx)("p",{className:"text-sm text-green-600 dark:text-green-400",children:p})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Название статьи *"}),(0,a.jsx)("input",{type:"text",id:"title",name:"title",required:!0,value:e.title,onChange:w,placeholder:"Введите подходящее для статьи название: ",className:"input-field text-lg font-medium",disabled:g})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"image_url",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"URL Картинки"}),(0,a.jsx)("input",{type:"url",id:"image_url",name:"image_url",value:e.image_url,onChange:w,placeholder:"https://example.com/image.jpg (400x200px рекомендуется)",className:"input-field",disabled:g}),(0,a.jsx)("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:"Опционально. Рекомендованный размер картинки: 400x200px. Можно оставить пустым."})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Tags"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("input",{type:"text",value:r,onChange:e=>i(e.target.value),onKeyDown:a=>{if("Enter"===a.key||","===a.key){a.preventDefault();let s=r.trim().toLowerCase();s&&!e.tags.includes(s)&&(t(e=>({...e,tags:[...e.tags,s]})),i(""))}},placeholder:"Type a tag and press Enter or comma...",className:"input-field",disabled:g}),(0,a.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:'Использовать Enter или "," для тегов. Например: js, java, tutorial'}),e.tags.length>0&&(0,a.jsx)("div",{className:"flex flex-wrap gap-2 mt-3",children:e.tags.map(e=>(0,a.jsxs)("span",{className:"inline-flex items-center px-3 py-1 bg-violet-100 dark:bg-violet-900 text-violet-800 dark:text-violet-200 text-sm font-medium rounded-full",children:["#",e,(0,a.jsx)("button",{type:"button",onClick:()=>S(e),className:"ml-2 text-violet-600 hover:text-violet-800 dark:text-violet-400 dark:hover:text-violet-200",disabled:g,children:(0,a.jsx)(o,{className:"h-3 w-3"})})]},e))})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Контент статьи *"}),(0,a.jsx)(u,{value:e.content,onChange:e=>{t(t=>({...t,content:e})),h&&b("")},placeholder:"Напишите статью в формате Markdown..."})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between pt-6 border-t border-gray-200 dark:border-gray-700",children:[(0,a.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"* Обязательные поля"}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)(x.default,{href:"/",className:"btn-secondary",children:"Отмена"}),(0,a.jsx)("button",{type:"submit",disabled:g||!e.title.trim()||!e.content.trim(),className:"btn-primary disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",children:g?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(c.Z,{className:"h-4 w-4 animate-spin"}),(0,a.jsx)("span",{children:"Отправляю..."})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(d,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Опубликовать"})]})})]})]})]})]}):null}},1656:function(e,t,r){"use strict";r.d(t,{Z:function(){return i}});var a=r(7437),s=r(236),l=r(3260),n=r(2158);function i(e){let{content:t}=e;return(0,a.jsx)("div",{className:"prose prose-lg dark:prose-invert max-w-none",children:(0,a.jsx)(s.UG,{remarkPlugins:[l.Z],rehypePlugins:[n.Z],components:{h1:e=>{let{children:t}=e;return(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900 dark:text-gray-100 mb-6 pb-2 border-b border-gray-200 dark:border-gray-700",children:t})},h2:e=>{let{children:t}=e;return(0,a.jsx)("h2",{className:"text-2xl font-semibold text-gray-900 dark:text-gray-100 mb-4 mt-8",children:t})},h3:e=>{let{children:t}=e;return(0,a.jsx)("h3",{className:"text-xl font-semibold text-gray-900 dark:text-gray-100 mb-3 mt-6",children:t})},p:e=>{let{children:t}=e;return(0,a.jsx)("p",{className:"text-gray-700 dark:text-gray-300 mb-4 leading-relaxed",children:t})},code:e=>{let{node:t,inline:r,className:s,children:l,...n}=e,i=/language-(\w+)/.exec(s||"");return!r&&i?(0,a.jsx)("div",{className:"relative",children:(0,a.jsx)("pre",{className:"bg-gray-100 dark:bg-gray-900 rounded-lg p-4 overflow-x-auto mb-4",children:(0,a.jsx)("code",{className:s,...n,children:l})})}):(0,a.jsx)("code",{className:"bg-gray-100 dark:bg-gray-800 px-2 py-1 rounded text-sm font-mono",...n,children:l})},blockquote:e=>{let{children:t}=e;return(0,a.jsx)("blockquote",{className:"border-l-4 border-violet-500 pl-4 my-4 italic text-gray-600 dark:text-gray-400",children:t})},ul:e=>{let{children:t}=e;return(0,a.jsx)("ul",{className:"list-disc list-inside mb-4 space-y-2",children:t})},ol:e=>{let{children:t}=e;return(0,a.jsx)("ol",{className:"list-decimal list-inside mb-4 space-y-2",children:t})},li:e=>{let{children:t}=e;return(0,a.jsx)("li",{className:"text-gray-700 dark:text-gray-300",children:t})},a:e=>{let{href:t,children:r}=e;return(0,a.jsx)("a",{href:t,className:"text-violet-600 dark:text-violet-400 hover:underline",target:"_blank",rel:"noopener noreferrer",children:r})},table:e=>{let{children:t}=e;return(0,a.jsx)("div",{className:"overflow-x-auto mb-4",children:(0,a.jsx)("table",{className:"min-w-full border border-gray-200 dark:border-gray-700 rounded-lg",children:t})})},th:e=>{let{children:t}=e;return(0,a.jsx)("th",{className:"px-4 py-2 bg-gray-100 dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 text-left font-semibold",children:t})},td:e=>{let{children:t}=e;return(0,a.jsx)("td",{className:"px-4 py-2 border-b border-gray-200 dark:border-gray-700",children:t})}},children:t})})}r(7792)},1837:function(e,t,r){"use strict";r.d(t,{x:function(){return s}}),r(257);class a{getBaseUrl(){return"http://localhost:8081"}initializeToken(){this.token=localStorage.getItem("auth_token")}isAuthenticated(){return this.token=localStorage.getItem("auth_token"),!!this.token}async request(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r="".concat(this.baseUrl).concat(e),a={"Content-Type":"application/json",...t.headers};this.token=localStorage.getItem("auth_token"),this.token&&(a.Authorization="Bearer ".concat(this.token));try{console.log("Making request to: ".concat(r));let e=await fetch(r,{...t,headers:a,mode:"cors"});if(!e.ok){if(401===e.status)throw this.logout(),Error("Unauthorized - please login again");throw Error("HTTP error! status: ".concat(e.status))}return await e.json()}catch(e){throw console.error("API request failed:",e),e}}async login(e){try{var t;let r=await this.request("/api/auth/login",{method:"POST",body:JSON.stringify(e)});if(!r.success||null===(t=r.data)||void 0===t||!t.access_token)return console.error("Login failed or no token received:",r),{data:{},success:!1,message:"Login failed"};return this.token=r.data.access_token,localStorage.setItem("auth_token",this.token),console.log("Token saved to localStorage:",this.token.substring(0,20)+"..."),{data:r.data,success:!0}}catch(e){return console.error("Login error:",e),{data:{},success:!1,message:e instanceof Error?e.message:"Login failed"}}}logout(){this.token=null,localStorage.removeItem("auth_token")}async getArticles(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;try{return{data:await this.request("/api/articles?page=".concat(e,"&limit=").concat(t)),success:!0}}catch(e){return console.error("Failed to get articles:",e),{data:{},success:!1,message:e instanceof Error?e.message:"Failed to get articles"}}}async getArticle(e){try{return{data:await this.request("/api/articles/".concat(e)),success:!0}}catch(e){return console.error("Failed to get article:",e),{data:{},success:!1,message:e instanceof Error?e.message:"Failed to get article"}}}async createArticle(e){try{return{data:await this.request("/api/articles",{method:"POST",body:JSON.stringify(e)}),success:!0}}catch(e){return console.error("Failed to create article:",e),{data:{},success:!1,message:e instanceof Error?e.message:"Failed to create article"}}}async searchArticles(e){try{return{data:await this.request("/api/articles/search?q=".concat(encodeURIComponent(e))),success:!0}}catch(e){return console.error("Failed to search articles:",e),{data:{},success:!1,message:e instanceof Error?e.message:"Failed to search articles"}}}constructor(){this.token=null,this.baseUrl=this.getBaseUrl(),this.initializeToken()}}let s=new a}},function(e){e.O(0,[851,451,948,971,117,744],function(){return e(e.s=2129)}),_N_E=e.O()}]);